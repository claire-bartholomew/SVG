import iris
import matplotlib.pyplot as plt
import numpy as np
import pdb

#job = '2096360'
#mse = [0.0017147963572642774, 0.00021038943961805968, 0.0002024467469794522, 0.00020199888405234882, 0.00019639954890590162, 0.0001913328027973574, 0.00018761703984152207, 0.00018039705621777097, 0.00017677485676540513, 0.0001708543853019362, 0.00017042614295496617, 0.00016760605149708375, 0.000157020246348111, 0.00014998409510008057, 0.00014636052215549468, 0.00014203148824162777, 0.0001358357026086497, 0.00013002636622210648, 0.00012038880074881799, 0.00011371868049415454, 0.00011487600641460934, 0.00010253108811351307, 0.00010454413171585977, 9.17571803341464e-05, 8.850770839975057e-05, 8.712230101324777e-05, 8.295620817322446e-05, 7.762584763016395e-05, 7.573998859637268e-05, 7.265564007199527e-05, 7.175914341739061e-05, 6.68925424154925e-05, 6.613537495043911e-05, 6.197805583360603e-05, 6.4459041847537e-05, 5.919595291682833e-05, 6.370268569298795e-05, 5.563250543006391e-05, 5.7192256567456466e-05, 5.468697469526276e-05, 5.583055021998005e-05, 5.061254337488203e-05, 5.2024324126250574e-05, 5.0392915184299114e-05, 5.2121640854844985e-05, 4.6433268299248684e-05, 4.741702764780103e-05, 4.717367920481283e-05, 4.7398643209210844e-05, 4.649982382640401e-05]
#kld = [7.165958177211002e-05, 1.7033097950237194e-06, 1.3528322404757389e-06, 1.2533818929417373e-06, 2.799578046354629e-06, 4.7420127396738615e-06, 6.207707641806339e-06, 5.624696454106014e-06, 5.583040769579384e-06, 6.292907736375739e-06, 4.752600010154612e-06, 8.535741423960037e-06, 2.225497152570217e-06, 1.5081654206596806e-06, 1.997407800748381e-06, 2.5750399006483336e-06, 1.2056795488888381e-06, 1.0645950986448343e-06, 2.6351253740889032e-06, 6.236409243077403e-07, 8.389886599559304e-06, 2.043243285413613e-06, 1.2177241456849215e-06, 7.283099114943069e-07, 8.550105180944456e-07, 5.003561647356497e-07, 2.3521483159782964e-07, 3.680494985474072e-07, 2.929478927976938e-07, 1.0471162772489597e-06, 4.025543773167333e-07, 2.041871376879573e-07, 3.3614288259305606e-07, 2.694363438232963e-07, 3.621225605125272e-07, 2.9297968215639477e-07, 1.2540693210259702e-06, 3.1027645235415214e-07, 2.804808362579791e-07, 2.595039742905315e-07, 5.32413034047607e-07, 2.2463500780152843e-07, 2.619999181684799e-07, 2.8125271605361487e-07, 6.385281799670873e-07, 2.268893057075045e-07, 4.5201133381548637e-07, 1.8523112193324924e-07, 2.2901123075177078e-07, 2.608977294095891e-07]

#job = '2097155'   #best so far
#mse = [0.0005307663184799621, 0.00018628410270182547, 0.00016499239384141435, 0.00013950596988988347, 0.00011179257892187279, 8.856288742230854e-05, 7.32235266929689e-05, 6.41483426328859e-05, 5.6347896122145484e-05, 5.116230731617157e-05, 4.758154432573033e-05, 4.354052084327943e-05, 4.113061373103307e-05, 3.928504462174477e-05, 3.7721623597919505e-05, 3.636833458444158e-05, 3.4226283380467896e-05, 3.748732626557497e-05, 3.2666514324607055e-05, 3.1185529712614566e-05, 3.097116004071375e-05, 2.943092331039183e-05, 2.931319330071827e-05, 2.8275144251596317e-05, 2.7874252754678486e-05, 2.748861456375387e-05, 2.730696007247698e-05, 2.7083628571035094e-05, 2.55668930273686e-05, 2.6025481659182068e-05, 2.5339544523798955e-05, 2.504617406378202e-05, 2.4545482415535422e-05, 2.4477336475295325e-05, 2.4019698180139175e-05, 2.396510847891257e-05, 2.355439276695282e-05, 2.314354715001427e-05, 2.3179728204174762e-05, 2.284035499188023e-05, 2.2987233801733296e-05, 2.4738224807390574e-05, 2.309434468355919e-05, 2.2864065835306828e-05, 2.2051366571336324e-05, 2.1780791047647316e-05, 2.5095107818518293e-05, 2.2289691365129205e-05, 2.2076745595508524e-05, 2.133131675149379e-05]
#kld = [1.6911757476353178e-05, 5.8197444567028746e-06, 3.550972511679291e-06, 2.6076156852575474e-06, 3.885132210335247e-06, 1.0333603852286342e-06, 3.9447997320298285e-07, 5.144437293396521e-07, 4.89970669876869e-07, 6.650663539330082e-07, 3.0829965465567644e-07, 2.738651784391063e-07, 1.737193204096427e-07, 1.4436322576280468e-07, 2.33962211761451e-07, 2.9877247962224693e-07, 1.2462321859446367e-07, 3.403364550121591e-06, 1.3037500251238151e-07, 1.8252455148779014e-07, 1.0111443252752507e-07, 9.426419879302783e-08, 1.006828800644002e-07, 1.6306719394233154e-07, 1.434984534471758e-07, 8.64032448691372e-08, 1.0507205599227312e-07, 1.0417008449314764e-07, 9.38818324831649e-08, 1.4160876841827015e-07, 1.0320382061305167e-07, 9.24595563025333e-08, 1.1454316370603634e-07, 1.498317156174466e-07, 1.0261411700030259e-07, 2.882013662910735e-07, 1.0717423809189993e-07, 7.783083021306376e-08, 1.121708040215793e-07, 7.721043239902979e-08, 1.1001750027397225e-07, 1.2815299873185858e-07, 2.989520773826003e-07, 9.912112275823477e-07, 1.7489646919311066e-07, 1.9991348718343265e-07, 2.473715958644959e-06, 5.215908581620445e-07, 6.829929593831769e-07, 1.585800195243513e-07]
#n_epochs = 50

#job = '2108727'
#mse = [0.0007624680933496861, 0.0006452553436735591, 0.0006493598853105553, 0.000648830423089084, 0.0006504839670227528, 0.000648767061026405, 0.0006512823391253528, 0.0006501376358835857, 0.0006488841725513339, 0.0006491873230008023, 0.0006492937070806063, 0.0006502511741678816, 0.0006493232406230311, 0.0006499561485923469, 0.0006492135489831881, 0.0006490266380272533, 0.0006479824962513386, 0.0006506060066703149, 0.0006500750844444806, 0.0006495946743480222, 0.0006496484982203229, 0.0006488220824478383, 0.0006498643473248627, 0.0006492107321439688, 0.0006500696451779491, 0.0006497836423610125, 0.0006493936792295905, 0.0006500396483092642, 0.000649168822443326, 0.000650080585626995, 0.0006505208557036875, 0.0006492021092459636, 0.0006489148936812291, 0.0006495844619777005, 0.0006499168928460618, 0.0006496491501713235, 0.000649975252313058, 0.0006492074887971447, 0.0006499123315870814, 0.0006488088422880242, 0.0006500827301845274, 0.0006507895657721131, 0.0006496751831612967, 0.0006490074310740341, 0.0006495434975299934, 0.0006494100708176797, 0.0006498224446838957, 0.0006494339793120233, 0.0006499312969953067, 0.0006498140207418564]
#kld = [0.0008964805265802548, 3.4677106920722575e-06, 2.4124588408712085e-06, 1.9248054904577357e-06, 0.4851282058202116, 0.012818733424057142, 0.00408529980278818, 0.0028224486711041657, 0.0027145696647069097, 0.0026395659157992216, 0.0025526277787220244, 0.002617483300047996, 0.0026519657019928975, 0.002612092619033429, 0.0026102662903577873, 0.0026629459752578865, 0.002668179394233793, 0.0025800724103939303, 0.0026301660396234, 0.0025828574954775392, 0.002606134596153081, 0.0026178220166014356, 0.002595728769102825, 0.002625475243314521, 0.002591590989719748, 0.0026048230746435704, 0.0025873488463020577, 0.0026252461922547194, 0.002603086464719857, 0.0026183057893578317, 0.0026141469956820484, 0.002600302009656491, 0.0025947231363940525, 0.002579768655706105, 0.002608054318340309, 0.0026374594258711656, 0.002585278819133707, 0.0025895751776203258, 0.00262550720232734, 0.0025987326776310484, 0.002618670056091586, 0.002589704915558623, 0.002603357922807225, 0.002607396780412431, 0.0025882935229403978, 0.002609932784953334, 0.002614796747591935, 0.002598161239601662, 0.002620133421078738, 0.0026164658475145795]

#job = '2181979'
#mse = [0.00019275855230275476, 8.087702469506268e-05, 6.191379195903813e-05, 4.851372935863079e-05, 3.8853069593810744e-05, 3.323273872916218e-05, 2.967546357380073e-05, 2.7195643766289286e-05, 2.5199605001438955e-05, 2.379694178297445e-05]
#kld = [8.053337701621e-06, 0.0004141355862102597, 2.4801640717696254e-06, 5.271142105988186e-06, 4.921912813107883e-07, 3.7236968909366334e-07, 4.1696631669564353e-07, 3.6358724796488885e-07, 1.0534464849754165e-06, 3.212485103581199e-07]

#job = '665443'
#mse = [0.00044626966095241797, 7.772809271646928e-05, 7.013828624957935e-05, 5.7779674891134294e-05, 4.30503915651615e-05, 3.252227137213913e-05, 2.6658686422209103e-05, 2.3329527571077577e-05, 2.001509244357955e-05, 1.806054197909971e-05, 1.615994416743518e-05, 1.518964065882598e-05, 1.3699462054924162e-05, 1.2818071506797579e-05, 1.2630894165902297e-05, 1.1394803081055576e-05, 1.1245036560166752e-05, 1.0765256503366786e-05, 1.0350745034955171e-05, 9.906072867677265e-06, 9.856787268681746e-06, 9.260150498102165e-06, 9.177481751976304e-06, 8.938638519824227e-06, 8.668187910704618e-06, 8.644436133323167e-06, 8.173779863184897e-06, 8.155486139895601e-06, 8.037020731967232e-06, 7.795348212592943e-06, 7.721403838228087e-06, 7.657287419645104e-06, 7.5998451069225345e-06, 7.527351890281194e-06, 8.59128424400253e-06, 7.72476448034045e-06, 7.060350727766879e-06, 7.290835806633237e-06, 6.995204058915089e-06, 6.913468914218963e-06, 6.755600381444108e-06, 6.790359428039363e-06, 6.674201820919831e-06, 6.6470967640021514e-06, 6.561622561777599e-06, 6.543155896299029e-06, 6.435978101123742e-06, 6.370447125088867e-06, 6.450624595795446e-06, 6.260635958743052e-06]
#kld = [3.42453440871766e-05, 1.331965366310898e-06, 1.2487917821263613e-06, 1.2055913145931992e-06, 6.843585242459986e-07, 2.856711763559206e-07, 1.6155369416135307e-07, 1.8966899258693083e-07, 1.6660670314549174e-07, 1.4106524189303147e-07, 1.1235513312988147e-07, 1.2080686603718572e-07, 1.3209675344268165e-07, 8.04980414376498e-08, 1.5531649287468852e-07, 7.028257490184784e-08, 7.745104448299841e-08, 7.657369275517437e-08, 1.245069977495948e-07, 6.430716633815245e-08, 7.516861853712832e-08, 5.992669780907861e-08, 8.896047122188008e-08, 7.250689059587402e-08, 6.489321411561883e-08, 6.809648005695398e-08, 6.344572653389467e-08, 6.859280911143309e-08, 6.133488981137414e-08, 6.09147868722858e-08, 6.574900934633557e-08, 6.650541015736925e-08, 6.565515163742912e-08, 1.1807450195615293e-07, 7.363757257183201e-07, 9.247487632041073e-08, 6.55609709985761e-08, 1.4356435786892642e-07, 6.591570699893057e-08, 7.250215985799472e-08, 6.018553301748001e-08, 6.584292111646687e-08, 6.311200919210316e-08, 6.20530699625175e-08, 6.223180862663086e-08, 5.7109292567120275e-08, 6.474248218742528e-08, 6.30427713596084e-08, 6.377288547717312e-08, 6.508754202921193e-08]

#job = '2161339' #
#mse = [7.918016851230506e-05, 6.949386905902274e-05, 6.261589826188612e-05, 5.925269105874026e-05, 6.234968594348609e-05, 5.4069695033470664e-05, 5.4470310107043673e-05, 4.968166680853017e-05, 4.583886086518731e-05, 4.256399485787679e-05, 4.08168972456918e-05, 3.769863983115825e-05, 3.630814236028593e-05, 3.307704379755347e-05, 3.348212842621144e-05, 3.1067888829123704e-05, 2.8898043196553217e-05, 2.7205909966980542e-05, 2.6974366478640996e-05, 2.5289984076513512e-05, 2.4516510926507445e-05, 2.342913808385319e-05, 2.1906112623171826e-05, 2.182493072988546e-05, 2.1160646379378194e-05, 2.0206940104182814e-05, 1.935964242452257e-05, 1.9180218814278287e-05, 1.8737845484065538e-05, 1.852509558557551e-05, 1.8025248005850232e-05, 1.7932603035754765e-05, 1.925449644439912e-05, 1.7449190236193546e-05, 1.645576664928755e-05, 1.6010851293153985e-05, 1.5996554599622612e-05, 1.529289099527296e-05, 1.5098350425251123e-05, 1.4629592595436436e-05, 1.4510782889093714e-05, 1.4093008509537671e-05, 1.3875612019078823e-05, 1.3359431243316905e-05, 1.3400101176306164e-05, 1.2726554045076227e-05, 1.3094502401764597e-05, 1.292338805498723e-05]
#kld = [6.291870161930374e-05, 1.718378227637639e-06, 8.52305687114127e-07, 1.1062338415861666e-06, 4.212418525714652e-06, 2.110304582946914e-06, 1.8576639279174484e-06, 4.901131380280337e-06, 3.327763051118663e-05, 2.7385342477099664e-05, 2.6699475083752062e-05, 3.500571326036357e-05, 1.9933004994471352e-05, 2.439922962335342e-05, 2.299191478778477e-05, 2.227905884674366e-05, 2.1846945797670492e-05, 2.1656822660197577e-05, 2.0975551915477416e-05, 2.0479145062363192e-05, 2.021023657661263e-05, 1.989575140079407e-05, 1.971230838969522e-05, 1.9359492869331677e-05, 1.89408287828299e-05, 1.8864514351300088e-05, 8.010021170727493e-05, 1.2907154569391436e-05, 1.876467375639554e-05, 1.7869459508583952e-05, 1.7988664055671035e-05, 1.8201634413769633e-05, 2.6383595791243684e-05, 2.669962127849622e-05, 2.5418341133881634e-05, 2.4941935059532404e-05, 2.253198119018641e-05, 2.0451354426333796e-05, 1.7784481405205875e-05, 1.770842173144305e-05, 1.754403796822767e-05, 1.7240637310188595e-05, 1.7200768482648456e-05, 1.6851670889810423e-05, 1.6723415189573374e-05, 1.6622675178042688e-05, 1.649533039450339e-05, 1.621657410315069e-05]

#job = '3328096' #64
#mse = [0.01540803842726745, 0.00026117143133888023, 0.00017239023909496604, 0.00025970617234634115, 0.00013712989411942544, 0.0002259484701880865, 0.00014389884290721974, 0.00018283070435245465, 0.0001511840053353808, 0.00013090794411709794, 0.00012736336784655578, 0.00010550609529218493, 9.482346179083835e-05, 7.741978225794811e-05, 0.00013524197615879532, 5.170145768715885e-05, 0.0001434290459769727, 5.994527944039873e-05, 0.00012560201990936546, 7.490756267998224e-05, 0.00010835318341833046, 0.0001525247175095501, 0.00010763367320123506, 9.934917443388258e-05, 7.872078077753031e-05, 9.439405198463642e-05, 6.287196060839052e-05, 0.0001371525205740909, 5.331359451474782e-05, 0.00013031068397140186, 5.07296699993276e-05, 0.0001369199833334278, 9.753077733876127e-05, 9.587656650182908e-05, 7.045239021863378e-05, 8.807591755157775e-05, 7.537769625969306e-05, 7.305421996761652e-05, 0.0001789699917253529, 0.00014492447267002717, 0.00019903896572941442, 9.898137082018365e-05, 0.00015885377464428533, 5.0186540818231144e-05, 0.00012615829456308345, 5.5986379788919276e-05, 0.00010954441849548857, 0.00012912454892557434, 0.00011940938240968536, 8.960892741924908e-05]
#kld = [0.0016521742460099626, 9.640894672884318e-05, 2.6761582671497314e-05, 1.070351131033931e-05, 5.563902760741256e-06, 6.267805690640672e-06, 3.133616472439372e-06, 3.1357678238919104e-06, 2.0900159348968833e-06, 1.7960253437365737e-06, 1.9870233089136496e-06, 2.0654732608704762e-06, 3.6735274221655338e-06, 3.099932860095578e-06, 2.834931989070809e-06, 1.6997918031336212e-06, 1.6748206938643758e-06, 1.1262507193521285e-06, 3.3144071068136325e-06, 1.1879136057046935e-06, 1.1300132882752219e-06, 6.418395852136886e-07, 2.0339619922538076e-06, 1.518104703279732e-06, 9.129406091545889e-07, 7.082103007149954e-07, 9.430712321290004e-07, 1.4498108185989617e-06, 1.7068302277323254e-06, 1.4767702879225911e-06, 9.77620962316905e-07, 4.771142382509198e-07, 3.679841803716498e-07, 3.830762624446039e-07, 3.374158479729772e-07, 3.433669975905217e-07, 3.952486553160383e-07, 3.67385807287235e-07, 4.756916414550006e-07, 6.184028517708384e-07, 2.69475397089991e-06, 2.1895184445952507e-06, 1.1181435777274373e-06, 5.239271633428188e-07, 4.698522470647505e-07, 4.0089712616264706e-07, 5.4728938749804e-07, 8.065370028731423e-07, 4.1286694596465173e-07, 5.248445162919781e-07]

#job2 = '3328108' #128
#mse2 = [0.007834586496892374, 0.00021605543597615905, 0.00018153487205836426, 0.00016346580844128764, 0.0001414843143038524, 0.00013356888932776202, 8.666599378557293e-05, 0.00010411393083700203, 9.104722590791425e-05, 8.869021540931501e-05, 0.00013247163512915, 0.00010801339927866136, 9.713204783565744e-05, 8.867587180247936e-05, 0.00011007571339405331, 0.0001709128619268085, 0.00013223343546542302, 0.00010674088044879681, 8.20211655650382e-05, 9.710288709356975e-05, 7.217013699403199e-05, 8.90086999959294e-05, 0.00010246656824506318, 0.000123151879370198, 0.000108815042273136, 0.00010298744043666372, 9.82401746000505e-05, 0.00010757228393742932, 0.00016309880770108972, 0.00010332665174814792, 8.406063072357026e-05, 8.389595848257156e-05, 0.0001620167521707572, 0.00011659815280040675, 9.565393945365491e-05, 0.00010128259355042249, 0.0001083125449156341, 9.093971773097564e-05, 7.305648053090864e-05, 8.270371975243049e-05, 0.00010117894088352838, 0.00010378058855451406, 7.003126014240026e-05, 7.05294241328147e-05, 7.611331029977465e-05, 0.00010638125759783177, 6.30514847472341e-05, 7.39899608760197e-05, 7.554899305546317e-05, 8.918464615561565e-05]
#kld2 = [0.0008741978468833621, 1.8677206614370338e-05, 5.699878198583973e-06, 3.1519530402590603e-06, 1.9316387223966557e-06, 1.6171019861843666e-06, 1.8377229917376783e-06, 2.8190413011941482e-06, 1.258212172672301e-06, 8.558377292189333e-07, 1.2928270979983832e-06, 3.6140054394451226e-06, 7.271617786841487e-06, 4.239942710171362e-06, 3.757997266262692e-06, 5.245290342514864e-07, 2.702244118912844e-07, 1.8705730533419285e-07, 2.2737891911539517e-07, 2.632371643329634e-07, 2.3717875963225057e-07, 1.5563215423064493e-07, 1.569278563096077e-07, 1.9196886700267862e-07, 3.29460021974981e-07, 5.215068880737307e-07, 2.6128488239685055e-07, 7.680582411850879e-07, 4.1098218348523137e-07, 1.6424292994088323e-06, 8.123659229752883e-07, 3.6115060098040896e-07, 2.7167727831844943e-07, 5.470949815844506e-07, 5.393498676120601e-07, 4.6288827855178716e-07, 3.548979344625283e-07, 3.265321777412567e-07, 4.0883548266812384e-07, 3.0912342787736694e-07, 3.482890368555757e-07, 4.562642512695449e-07, 3.1953445289723e-07, 2.3207511077871783e-07, 2.4562236284886285e-07, 2.531753893642019e-07, 3.1187199485138715e-07, 1.9130646580212138e-07, 2.7504051738347355e-07, 2.782000270595829e-07]

mse = [0.0019995409164494074, 8.485381334821783e-05, 6.902174704919157e-05, 6.809131159002392e-05, 6.896386697690107e-05, 6.915036256316397e-05, 6.822868542428754e-05, 8.279738988505867e-05, 7.073146962852666e-05, 6.825147644349274e-05, 6.794246749279862e-05, 6.77095535536409e-05, 7.268481166420316e-05, 6.656950511683133e-05, 6.80838627602043e-05, 6.649795407156484e-05, 6.442991602852991e-05, 6.672933136826482e-05, 6.481046133615107e-05, 6.345870334598664e-05, 6.37174347588143e-05, 6.407327388160413e-05, 6.05672276833502e-05, 6.323414949349625e-05, 6.001621198379329e-05, 5.918177061232658e-05, 5.89004513102509e-05, 5.755172391843642e-05, 5.9867480689490505e-05, 5.7942364119867316e-05, 5.6270415194603594e-05, 5.5435871084341635e-05, 5.651655050371575e-05, 5.4163050620559254e-05, 5.097381415453126e-05, 5.198991534882684e-05, 4.9899137218289924e-05, 5.024883287774171e-05, 4.907906958635519e-05, 4.7890042722542644e-05, 4.7405849528558954e-05, 4.657327812651597e-05, 4.685901177623463e-05, 4.6955033459994426e-05, 4.7291926378534326e-05, 4.631536010748503e-05, 4.5284076659868356e-05, 4.44787027987558e-05, 4.338600106734705e-05, 4.333785077790254e-05]
mse2 = [0.007566240891765115, 0.00015466997301700764, 0.00012747201117235815, 0.00014976318002482, 0.00010323062861061774, 8.281990558316466e-05, 7.347766595557916e-05, 8.00266864189325e-05, 7.114962968444163e-05, 7.019049539849221e-05, 6.79216120261117e-05, 6.69882051852255e-05, 6.888613083901874e-05, 7.053574097426464e-05, 6.871880542576039e-05, 6.560274258617938e-05, 7.030818555904264e-05, 6.947668975954002e-05, 6.433446175151404e-05, 7.185961288769249e-05, 7.04532316603945e-05, 7.360231363691125e-05, 6.484443183580882e-05, 6.983419177686302e-05, 7.089130324402503e-05, 6.690984572514934e-05, 7.044716408017848e-05, 6.661098857421167e-05, 6.137245127320062e-05, 9.10296995925819e-05, 7.520029997749587e-05, 6.267469235581304e-05, 6.542257073078873e-05, 6.918820719192807e-05, 6.700275066577887e-05, 7.129696306265033e-05, 6.556835878654968e-05, 6.514554786463121e-05, 6.631058032553483e-05, 7.396484852506549e-05, 6.869764122257039e-05, 6.343864956761535e-05, 6.758088987908195e-05, 7.376269143151147e-05, 6.698319521092345e-05, 6.519465944165859e-05, 7.030698595826833e-05, 6.923776860503492e-05, 6.792489816689341e-05, 7.514869766964697e-05]

n_epochs = 50

fig, ax1 = plt.subplots()
e = np.arange(n_epochs)

color = 'tab:red'
ax1.set_xlabel('Epoch')
ax1.set_ylabel('MSE', color=color)
ax1.plot(e, mse, color=color, label='512')
ax1.plot(e, mse2, color=color, linestyle='dashed', label='128')
ax1.tick_params(axis='y', labelcolor=color)

#ax2 = ax1.twinx()  # instantiate a second axes that shares the same x-axis
#color = 'tab:blue'
#ax2.set_ylabel('KLD', color=color)  # we already handled the x-label with ax1
#ax2.plot(e, kld, color=color)
#ax2.plot(e, kld2, color=color, linestyle='dashed')
#ax2.tick_params(axis='y', labelcolor=color)

fig.tight_layout()  # otherwise the right y-label is slightly clipped
plt.show()
